\chapter{Introduction}


% \emph{}

\section{Problem Statement and Approach} 

Data undeniably plays a critical role in driving companies, especially in rapidly evolving business environments. Data offers insights that can solve problems, lead to improvements, help in making informed decisions, understand customer preferences, enhance marketing strategies, reduce costs, manage risks, and much more. Relying solely on specialists to retrieve data efficiently can be costly and time-consuming. Therefore, creating a query support tool that assists users in retrieving data from databases efficiently would be highly beneficial for fast-growing travel technology companies like Agoda.

At Agoda, the majority of employees are non-IT employees, which poses a challenge when retrieving important data. These employees often need to construct query statements, leading to inefficiencies in their workflow. They must either invest time in learning SQL or wait for the support team to respond to their query-related tickets, which can delay decision-making and reduce overall productivity.

This project aims to simplify data access and enhance productivity by enabling employees, especially non-technical users, to retrieve information without requiring SQL expertise. The Query Assistance tool leverages advanced technologies, including Large Language Models (LLMs) and LangChain, to provide comprehensive query support. It can fix incorrect queries, optimize performance, convert database syntax, and generate SQL statements from natural language input.

Initially, the tool will be developed as an API platform, allowing integration with various systems. In its later phase, it will be embedded into Superset to assist users directly within SQL Lab, streamlining workflows and reducing dependence on support teams. The integration with OpenMetadata enhances its capabilities, enabling the tool to analyze metadata and intelligently select the appropriate tables and columns for query construction. By combining these features, the Query Assistance tool addresses inefficiencies in query handling, helping organizations like Agoda save time, reduce costs, and improve decision-making processes.

\section{Objectives}
1.2.1 	To enhance correctness and increase efficiency in construction of queries.

1.2.2 	To develop API endpoints leveraging LLM services capable of fixing, converting, optimizing, and constructing queries.

1.2.3	To integrate Query Assistance with Agoda's existing services and tools, such as Superset and Slack,

        \subsection{Objectives}
        \begin{itemize}
        \item  Simplify data access: Empower workers to retrieve data easily without needing to understand SQL.
        \item  Enhance query accuracy: Automatically correct SQL statements, from syntax to selecting the correct columns and tables.
        \item  Boost efficiency: Save time by quickly generating flawless SQL queries, optimizing both productivity and cost.
        \item  Facilitate advanced queries: Allow users to effortlessly create complex queries and explore advanced SQL techniques with minimal errors.
        \end{itemize}

\section{Scope of Work}
1.3.1	The API service to help solving SQL queries statement problems.

1.3.2	Develop capabilities for error handling in queries, ensuring syntax accuracy across multiple databases and correcting column and table names.

1.3.3	Implement query optimization techniques, utilizing partition columns to enhance performance and reduce both memory consumption and query execution time.

1.3.4	Build a module for translating natural language inputs into SQL query language.

1.3.5	Query Assist will only utilize data from Agoda Services to answer queries.

1.3.6	Query Assist will be integrated with Superset, Slack, and web-based platforms.

\section{Phases}
This project will be divided into three phases. The first phase focuses on error handling to ensure that we ultimately provide the correct query for the user. This includes correcting all syntax errors, accommodating syntax differences across databases, and fixing column names, table names, and typos in the query. The second phase focuses on optimizing the query such as using the partition column, decreasing memory consumption, and reducing the query execution time. The third and final phase aims to translate natural language into SQL query language.


\pagebreak
\section{Task and Schedule}
    \subsection{Semester 1}
        \begin{table}[!h]
            \centering % Ensures the table is centered
            \caption{Project schedule in the first semester}
            \label{tbl:gantt1}
            \resizebox{\textwidth}{!}{ % Resizes the Gantt chart to fit within the page width
                \begin{ganttchart}[
                    x unit = 0.5cm,
                    y unit chart = 1.2cm,
                    y unit title = 0.6cm,
                    title height = 1,
                    vgrid={*{3}{black, dotted}, *1{black, dashed}},
                    hgrid={*1{black, dashed}},
                    bar top shift = 0.1, 
                    bar height = 0.8,
                    bar label font=\small, % Adjust font size for labels
                    bar label node/.append style={
                        align=right,
                        text width=6cm % Set a fixed width for text wrapping
                    }
                ]{1}{20}
                    \gantttitle{Aug}{4} \gantttitle{Sep}{4} \gantttitle{Oct}{4} \gantttitle{Nov}{4} \gantttitle{Dec}{4} \\
                    \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \\
                    \ganttbar{Project Discussion with company}{1}{1} \\
                    \ganttbar{Project Idea}{2}{2} \\
                    \ganttbar{Project Brainstorm}{2}{3} \\
                    \ganttbar{Design architecture for project}{3}{4} \\
                    \ganttbar{Set up project}{4}{4} \\
                    \ganttbar{Design sequence diagram for create API to add and update Table details}{5}{6} \\
                    \ganttbar{Implement query assist table details API}{4}{4} \\
                    \ganttbar{Design sequence diagram for tools in Query Assist}{5}{6} \\
                    \ganttbar{Implement tools for Query Assist}{7}{7} \\
                    \ganttbar{Merge and Debug}{7}{8} \\
                    \ganttbar{Prompt Tuning \& Monitor result}{8}{9} \\
                    \ganttbar{CI/CD + Deploy}{9}{9} \\
                    \ganttbar{Slack Integration}{10}{15} \\
                    \ganttbar{Slack Tracking Performance + Enhance the MVP}{12}{13} \\
                    \ganttbar{Merge PostgreSQL}{14}{15} \\
                    \ganttbar{Merge Query Assist v1 with v2}{16}{17} \\
                    \ganttbar{POC and Design the Optimization function}{15}{15} \\
                    \ganttbar{Implement Optimization function}{18}{20}  % No extra \\
                \end{ganttchart}
            }
        \end{table}
    \textbf{Task breakdown}
\pagebreak
    \subsection{Semester 2}
        \begin{table}[!h]
            \centering
            \caption{Project schedule in the second semester}
            \label{tbl:gantt2}
            \begin{ganttchart}[
                x unit = 0.5cm,
                y unit chart = 1.2cm,
                y unit title = 0.6cm,
                title height = 1,
                vgrid={*{3}{black, dotted}, *1{black, dashed}},
                hgrid={*1{black, dashed}},
                bar top shift = 0.1, 
                %bar height = 0.8,
                bar label node/.append style={
                    align=right,
                    % text width=width("Present findings to advisors")
                }
            ]{1}{20}
                \gantttitle{Jan}{4} \gantttitle{Feb}{4} \gantttitle{Mar}{4} \gantttitle{Apr}{4} \gantttitle{May}{4} \\
                \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \gantttitlelist{1,...,4}{1} \\
                \ganttbar{Implement Optimization function}{1}{2} \\
                \ganttbar{Prompt Tuning \& Monitor result}{3}{5} \\
                \ganttbar{Superset Integration}{4}{5} \\
                \ganttbar{Get feedback + Enhance the functions}{5}{5} \\
                \ganttbar{POC and Design the Phase 3 functions}{6}{7} \\
                \ganttbar{Implement Phase 3 functions}{8}{14} \\
                \ganttbar{Prompt Tuning \& Monitor result}{14}{15} \\
                \ganttbar{Get feedback + Enhance the functions}{15}{17} \\
                \ganttbar{Implement Multi Agent}{16}{18} \\
                \ganttbar{Debug}{18}{19} \\
                \ganttbar{Improve and Finalize}{19}{20}  % No extra \\
            \end{ganttchart}
        \end{table}
    \textbf{Task breakdown}

\section{Expected Outcomes}
The end goal of the project is to develop a comprehensive Query Assist tool that enables users to efficiently retrieve and manage data without needing SQL expertise. Key features include automated error correction, performance optimization, and the ability to translate natural language into SQL queries, all integrated into platforms like Slack and Superset, fostering enhanced data access and decision-making capabilities.

\textbf{Semester 1}
\begin{itemize}
    \item  Overall system design
    \begin{itemize}
        \item Architecture Design
        \item Use Case Diagram
        \item Sequence Diagram
        \item Flow Chart
    \end{itemize}

    \item  Query Assist Phase 1
    \begin{itemize}
        \item Correcting all syntax errors
        \item Accommodating syntax differences across databases
        \item Fixing typos in column names, and table names
    \end{itemize}

    \item  Integrate into Slack
    \item Deploy MVC (Minimum viable product)
\end{itemize}

\textbf{Semester 2}
\begin{itemize}
    \item  Performance Metrics

    \item  Query Assist Phase 2
    \begin{itemize}
        \item Translate natural language to SQL query
    \end{itemize}

    \item Query Assist Phase 3
    \begin{itemize}
        \item Auto add partition column
        \item Decreasing memory consumption
        \item Reducing the query execution time
    \end{itemize}
\end{itemize}
\pagebreak